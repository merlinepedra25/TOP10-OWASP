
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OWASP Top 10:2021">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.0">
    
    
      
        <title>A07 Identification and Authentication Failures - OWASP Top 10:2021</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#a072021" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../.." title="OWASP Top 10:2021" class="md-header__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Top 10:2021
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A07 Identification and Authentication Failures
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../fr/" hreflang="fr" class="md-select__link">
                    Français
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../" hreflang="ja" class="md-select__link">
                    Japanese
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../zh_TW/" hreflang="zh_TW" class="md-select__link">
                    繁體中文
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../it/" hreflang="it" class="md-select__link">
                    Italiano
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../pt_BR/" hreflang="pt_BR" class="md-select__link">
                    Português (Brasil)
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/OWASP/Top10/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Top 10:2021" class="md-nav__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    OWASP Top 10:2021
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/OWASP/Top10/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../0x00-notice/" class="md-nav__link">
        Notice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_Introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="md-nav__link">
        How to use the OWASP Top 10 as a standard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="md-nav__link">
        How to start an AppSec program with the OWASP Top 10
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A00-about-owasp/" class="md-nav__link">
        About OWASP
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Top 10:2021 List
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Top 10:2021 List" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Top 10:2021 List
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A01_2021-Broken_Access_Control/" class="md-nav__link">
        A01 Broken Access Control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A02_2021-Cryptographic_Failures/" class="md-nav__link">
        A02 Cryptographic Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A03_2021-Injection/" class="md-nav__link">
        A03 Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A04_2021-Insecure_Design/" class="md-nav__link">
        A04 Insecure Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A05_2021-Security_Misconfiguration/" class="md-nav__link">
        A05 Security Misconfiguration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="md-nav__link">
        A06 Vulnerable and Outdated Components
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          A07 Identification and Authentication Failures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        A07 Identification and Authentication Failures
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    因子
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    解説
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    防止方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    攻撃シナリオの例
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    参考資料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cwe" class="md-nav__link">
    対応する CWE のリスト
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="md-nav__link">
        A08 Software and Data Integrity Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="md-nav__link">
        A09 Security Logging and Monitoring Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../A10_2021-Server-Side_Request_Forgery_(SSRF)/" class="md-nav__link">
        A10 Server Side Request Forgery (SSRF)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../A11_2021-Next_Steps/" class="md-nav__link">
        Next Steps
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    因子
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    解説
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    防止方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    攻撃シナリオの例
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    参考資料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cwe" class="md-nav__link">
    対応する CWE のリスト
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/OWASP/Top10/edit/master/docs/A07_2021-Identification_and_Authentication_Failures.ja.md" title="編集" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="a072021">A07:2021 – 識別と認証の失敗</h1>
<h2 id="_1">因子</h2>
<table>
<thead>
<tr>
<th align="center">対応する CWE 数</th>
<th align="center">最大発生率</th>
<th align="center">平均発生率</th>
<th align="center">最大網羅率</th>
<th align="center">平均網羅率</th>
<th align="center">加重平均（攻撃の難易度）</th>
<th align="center">加重平均（攻撃による影響）</th>
<th align="center">総発生数</th>
<th align="center">CVE 合計件数</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">22</td>
<td align="center">14.84%</td>
<td align="center">2.55%</td>
<td align="center">79.51%</td>
<td align="center">45.72%</td>
<td align="center">7.40</td>
<td align="center">6.50</td>
<td align="center">132,195</td>
<td align="center">3,897</td>
</tr>
</tbody>
</table>
<h2 id="_2">概要</h2>
<p>このカテゴリは、これまでの版では<em>認証の不備</em>として知られていたものです。前回は第2位でしたが今回は第7位に順位を落としました。また、この版では識別の失敗に関するいくつかのCWEを含めています。考慮すべきCWEには、<em>CWE-297:ホストの不一致による証明書の不適切な検証</em>、<em>CWE-287:不適切な認証</em>、<em>CWE-384:セッションの固定化</em>があります。</p>
<h2 id="_3">解説</h2>
<p>ユーザーのアイデンティ確認、認証そしてセッション管理は、認証関連の攻撃対策として極めて重要です。
もしアプリケーションに次に列挙するような問題があれば、認証に問題があると言えます。</p>
<ul>
<li>
<p>パスワードリスト攻撃（クレデンシャル・スタッフィング攻撃）のような自動化された攻撃が出来てしまう。パスワードリスト攻撃とは、攻撃者が正当なユーザー名とパスワードの組み合わせを入手して行う攻撃手法のことです。</p>
</li>
<li>
<p>ブルートフォース攻撃（総当たり攻撃）などの自動化された攻撃が出来てしまう。</p>
</li>
<li>
<p>デフォルトのパスワード、弱いパスワード、良く使われるパスワードが利用できてしまう。たとえば「Password1」や「admin/admin」などです。</p>
</li>
<li>
<p>クレデンシャルの復旧やパスワードを忘れた場合のプロセスが弱い、あるいは効果がない。たとえば「秘密の質問」のようなやり方は安全とは言えません。</p>
</li>
<li>
<p>パスワードを保存する際に、プレーンテキストのままで保存している、または暗号化して保存している。あるいはハッシュ化して保存していたとしても脆弱なハッシュ関数を利用している。（OWASP Top 10 2017 A3:機微な情報の露出　も参照）</p>
</li>
<li>
<p>多要素認証を採用していない。あるいは間違った使い方をしている。</p>
</li>
<li>
<p>セッションIDがURLの一部として露出してしまっている。（URLリライティングなどに注意）</p>
</li>
<li>
<p>ログイン後にセッションIDを変更していない。（セッション固定攻撃に注意）</p>
</li>
<li>
<p>セッションIDを正しく無効化していない。たとえば、ログアウトした際や一定期間リクエストが無い場合にも、ユーザーセッションや認証トークン（シングルサインオンのトークンなどが多い）が、無効化されない。</p>
</li>
</ul>
<h2 id="_4">防止方法</h2>
<ul>
<li>
<p>多要素認証を可能な限り実装する。これにより、パスワードリスト攻撃、ブルートフォース攻撃、盗用したクレデンシャルの再利用など多くの自動化された攻撃を防ぐことができます。</p>
</li>
<li>
<p>デフォルトのクレデンシャルのままプログラム（サービス）をデプロイしない。特に管理者ユーザーのパスワードをデフォルト設定のままデプロイするのは言語道断です。</p>
</li>
<li>
<p>弱いパスワードを設定していないかチェックする機能を実装する。たとえばパスワードの新規設定や更新時には、「弱いパスワード　トップ10,000」などのリストを使って検証する。</p>
</li>
<li>
<p>パスワードの「長さ」や「複雑さ」そして「定期的な変更」などのパスワードポリシーについては、NISTガイドライン（800-63b セクション5.1.1:記憶シークレット）や、近代的で根拠に基づくポリシーに沿うようにする。</p>
</li>
<li>
<p>新規登録の場合、クレデンシャルリカバリーの場合、またAPI経由の場合など、どのような場合であってもアカウント列挙攻撃に対して強化されていることを確認する。認証の際にはどのような結果であれ（成功でも失敗でも）同じメッセージを使うようにする。</p>
</li>
<li>
<p>ログイン試行回数に制限を設けるか、ログインに繰り返し失敗するようなら徐々に処理を遅延させる。ログインの失敗はすべてログに記録する。そしてパスワードリスト攻撃やブルートフォース攻撃などの攻撃を検知した際には管理者に通知する。</p>
</li>
<li>
<p>セッション管理はサーバ側で行い、安全でプログラム言語などに内蔵されているものを使います。ログイン毎にエントロピーの高いランダムなセッションIDを発行するセッション管理機構を利用する。セッションIDはURLに含まれるべきではなく、安全に保管されなければなりません。また、セッションIDはログアウトした際、一定期間アクセスが無い場合、タイムアウト時間を経過した場合には無効にしなければなりません。</p>
</li>
</ul>
<h2 id="_5">攻撃シナリオの例</h2>
<p><strong>シナリオ #1:</strong> 既知のパスワードリストを使う、パスワードリスト攻撃はよくある攻撃手法です。もしあるアプリケーションには、このようなリストを使う連続攻撃や、パスワードリスト攻撃への防御が組み込まれていなかったとしましょう。すると、そのアプリケーションはパスワードの神託所として利用されてしまいます。つまり、クレデンシャルが有効かどうかを判定することができてしまうのです。</p>
<p><strong>シナリオ #2:</strong> 認証を狙う攻撃の多くは、パスワードを唯一の認証要素として使い続けていることに起因します。「パスワードの定期的な変更」や「複雑なパスワードの要求」は、以前はベストプラクティスと考えられていましたが、ユーザーはかえって弱いパスワードをあちこちのサイトで使いまわすようになります。NIST 800-63のガイドラインに従って、このような昔ながらの慣習はもう辞めにしましょう、そして多要素認証を使いましょう。</p>
<p><strong>シナリオ #3:</strong> アプリケーションのセッションタイムアウトが正しく設定されていない。もしかしたらユーザーは公共のコンピュータからアクセスしているかもしれません。ユーザーが「ログアウト」をクリックせずに、表示しているブラウザのタブを閉じてどこかへ行ってしまったらどうなるでしょうか。セッションタイムアウトを設定していないと、攻撃者は１時間後にそのブラウザで先のユーザーになりすましてアプリケーションを利用できてしまいます。</p>
<h2 id="_6">参考資料</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-proactive-controls/v3/en/c6-digital-identity">OWASP Proactive Controls: Implement Digital
    Identity</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V2
    authentication</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V3 Session
    Management</a></p>
</li>
<li>
<p>OWASP Testing Guide: Identity, Authentication</p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html">OWASP Cheat Sheet:
    Authentication</a></p>
</li>
<li>
<p>OWASP Cheat Sheet: Credential Stuffing</p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html">OWASP Cheat Sheet: Forgot
    Password</a></p>
</li>
<li>
<p>OWASP Cheat Sheet: Session Management</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-automated-threats-to-web-applications/">OWASP Automated Threats
    Handbook</a></p>
</li>
<li>
<p>NIST 800-63b: 5.1.1 Memorized Secrets</p>
</li>
</ul>
<h2 id="cwe">対応する CWE のリスト</h2>
<p>CWE-255 証明書・パスワードの管理</p>
<p>CWE-259 ハードコードされたパスワードの使用</p>
<p>CWE-287 不適切な認証</p>
<p>CWE-288 代替パスまたはチャネルを使用した認証回避</p>
<p>CWE-290 スプーフィングによる認証回避</p>
<p>CWE-294 Capture-replay による認証回避</p>
<p>CWE-295 不正な証明書検証</p>
<p>CWE-297 ホストの不一致による証明書の不適切な検証</p>
<p>CWE-300 中間者の問題</p>
<p>CWE-302 認証回避の脆弱性</p>
<p>CWE-304 認証における重要なステップの欠落</p>
<p>CWE-306 重要な機能に対する認証の欠如</p>
<p>CWE-307 過度な認証試行の不適切な制限</p>
<p>CWE-346 同一生成元ポリシー違反</p>
<p>CWE-384 セッションの固定化</p>
<p>CWE-521 脆弱なパスワードの要求</p>
<p>CWE-613 不適切なセッション期限</p>
<p>CWE-620 未検証のパスワード変更</p>
<p>CWE-640 パスワードを忘れた場合の脆弱なパスワードリカバリの仕組み</p>
<p>CWE-798 ハードコードされた認証情報の使用</p>
<p>CWE-940 通信チャネルソースの不適切な検証</p>
<p>CWE-1216 ロックアウト機構の不備</p>
<h1 id="a072021-identification-and-authentication-failures">A07:2021 – Identification and Authentication Failures</h1>
<h2 id="factors">Factors</h2>
<table>
<thead>
<tr>
<th align="center">CWEs Mapped</th>
<th align="center">Max Incidence Rate</th>
<th align="center">Avg Incidence Rate</th>
<th align="center">Max Coverage</th>
<th align="center">Avg Coverage</th>
<th align="center">Avg Weighted Exploit</th>
<th align="center">Avg Weighted Impact</th>
<th align="center">Total Occurrences</th>
<th align="center">Total CVEs</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">22</td>
<td align="center">14.84%</td>
<td align="center">2.55%</td>
<td align="center">79.51%</td>
<td align="center">45.72%</td>
<td align="center">7.40</td>
<td align="center">6.50</td>
<td align="center">132,195</td>
<td align="center">3,897</td>
</tr>
</tbody>
</table>
<h2 id="overview">Overview</h2>
<p>Previously known as <em>Broken Authentication</em>, this category slid down
from the second position and now includes CWEs related to identification
failures. Notable CWEs included are <em>CWE-297: Improper Validation of
Certificate with Host Mismatch</em>, <em>CWE-287: Improper Authentication</em>, and
<em>CWE-384: Session Fixation</em>.</p>
<h2 id="description">Description</h2>
<p>Confirmation of the user's identity, authentication, and session
management is critical to protect against authentication-related
attacks. There may be authentication weaknesses if the application:</p>
<ul>
<li>
<p>Permits automated attacks such as credential stuffing, where the
    attacker has a list of valid usernames and passwords.</p>
</li>
<li>
<p>Permits brute force or other automated attacks.</p>
</li>
<li>
<p>Permits default, weak, or well-known passwords, such as "Password1"
    or "admin/admin. "</p>
</li>
<li>
<p>Uses weak or ineffective credential recovery and forgot-password
    processes, such as "knowledge-based answers," which cannot be made
    safe.</p>
</li>
<li>
<p>Uses plain text, encrypted, or weakly hashed passwords (see
    A3:2017-Sensitive Data Exposure).</p>
</li>
<li>
<p>Has missing or ineffective multi-factor authentication.</p>
</li>
<li>
<p>Exposes Session IDs in the URL (e.g., URL rewriting).</p>
</li>
<li>
<p>Do not rotate Session IDs after successful login.</p>
</li>
<li>
<p>Does not correctly invalidate Session IDs. User sessions or
    authentication tokens (mainly single sign-on (SSO) tokens) aren't
    properly invalidated during logout or a period of inactivity.</p>
</li>
</ul>
<h2 id="how-to-prevent">How to Prevent</h2>
<ul>
<li>
<p>Where possible, implement multi-factor authentication to prevent
    automated credential stuffing, brute force, and stolen credential
    reuse attacks.</p>
</li>
<li>
<p>Do not ship or deploy with any default credentials, particularly for
    admin users.</p>
</li>
<li>
<p>Implement weak password checks, such as testing new or changed
    passwords against the top 10,000 worst passwords list.</p>
</li>
<li>
<p>Align password length, complexity, and rotation policies with NIST
    800-63b's guidelines in section 5.1.1 for Memorized Secrets or other
    modern, evidence-based password policies.</p>
</li>
<li>
<p>Ensure registration, credential recovery, and API pathways are
    hardened against account enumeration attacks by using the same
    messages for all outcomes.</p>
</li>
<li>
<p>Limit or increasingly delay failed login attempts. Log all failures
    and alert administrators when credential stuffing, brute force, or
    other attacks are detected.</p>
</li>
<li>
<p>Use a server-side, secure, built-in session manager that generates a
    new random session ID with high entropy after login. Session IDs
    should not be in the URL, be securely stored, and invalidated after
    logout, idle, and absolute timeouts.</p>
</li>
</ul>
<h2 id="example-attack-scenarios">Example Attack Scenarios</h2>
<p><strong>Scenario #1:</strong> Credential stuffing, the use of lists of known
passwords, is a common attack. Suppose an application does not implement
automated threat or credential stuffing protection. In that case, the
application can be used as a password oracle to determine if the
credentials are valid.</p>
<p><strong>Scenario #2:</strong> Most authentication attacks occur due to the continued
use of passwords as a sole factor. Once considered, best practices,
password rotation, and complexity requirements encourage users to use
and reuse weak passwords. Organizations are recommended to stop these
practices per NIST 800-63 and use multi-factor authentication.</p>
<p><strong>Scenario #3:</strong> Application session timeouts aren't set correctly. A
user uses a public computer to access an application. Instead of
selecting "logout," the user simply closes the browser tab and walks
away. An attacker uses the same browser an hour later, and the user is
still authenticated.</p>
<h2 id="references">References</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-proactive-controls/v3/en/c6-digital-identity">OWASP Proactive Controls: Implement Digital
    Identity</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V2
    authentication</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V3 Session
    Management</a></p>
</li>
<li>
<p>OWASP Testing Guide: Identity, Authentication</p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html">OWASP Cheat Sheet:
    Authentication</a></p>
</li>
<li>
<p>OWASP Cheat Sheet: Credential Stuffing</p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html">OWASP Cheat Sheet: Forgot
    Password</a></p>
</li>
<li>
<p>OWASP Cheat Sheet: Session Management</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-automated-threats-to-web-applications/">OWASP Automated Threats
    Handbook</a></p>
</li>
<li>
<p>NIST 800-63b: 5.1.1 Memorized Secrets</p>
</li>
</ul>
<h2 id="list-of-mapped-cwes">List of Mapped CWEs</h2>
<p>CWE-255 Credentials Management Errors</p>
<p>CWE-259 Use of Hard-coded Password</p>
<p>CWE-287 Improper Authentication</p>
<p>CWE-288 Authentication Bypass Using an Alternate Path or Channel</p>
<p>CWE-290 Authentication Bypass by Spoofing</p>
<p>CWE-294 Authentication Bypass by Capture-replay</p>
<p>CWE-295 Improper Certificate Validation</p>
<p>CWE-297 Improper Validation of Certificate with Host Mismatch</p>
<p>CWE-300 Channel Accessible by Non-Endpoint</p>
<p>CWE-302 Authentication Bypass by Assumed-Immutable Data</p>
<p>CWE-304 Missing Critical Step in Authentication</p>
<p>CWE-306 Missing Authentication for Critical Function</p>
<p>CWE-307 Improper Restriction of Excessive Authentication Attempts</p>
<p>CWE-346 Origin Validation Error</p>
<p>CWE-384 Session Fixation</p>
<p>CWE-521 Weak Password Requirements</p>
<p>CWE-613 Insufficient Session Expiration</p>
<p>CWE-620 Unverified Password Change</p>
<p>CWE-640 Weak Password Recovery Mechanism for Forgotten Password</p>
<p>CWE-798 Use of Hard-coded Credentials</p>
<p>CWE-940 Improper Verification of Source of a Communication Channel</p>
<p>CWE-1216 Lockout Mechanism Errors</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="フッター">
      
        
        <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="md-footer__link md-footer__link--prev" aria-label="前: A06 Vulnerable and Outdated Components" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                前
              </span>
              A06 Vulnerable and Outdated Components
            </div>
          </div>
        </a>
      
      
        
        <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="md-footer__link md-footer__link--next" aria-label="次: A08 Software and Data Integrity Failures" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                次
              </span>
              A08 Software and Data Integrity Failures
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>